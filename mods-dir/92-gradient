Modifications to gradient scheme to be more efficient than
naive forward differentiation.
